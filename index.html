<!DOCTYPE html>
<html>
<head>
    <title>GH Tax Calculator</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="">
</head>
<body>
<h2>Calculate your Tax</h2>
<h4>Get your income tax, SNIT and net income</h4>
<form>
    <label for="gross-income">Enter your gross income:</label> <br/>
    <span>GHC </span>
    <input id="gross-income" type="number" value="0">
    <br/><label for="allowances">Enter your gross income:</label> <br/>
    <span>GHC </span>
    <input id="allowances" type="number" value="0"> <br/>
    <input id="submit-button" type="button" value="Compute">
</form>
<div id="income-tax"></div>
<div id="ssnit-deduction"></div>
<div id="net-income"></div>
<script type="text/javascript">
    var ssnitRate = 5.5;
    var taxRates = [
        [0,216],
        [5,108],
        [10,151],
        [17.5,2765]
    ];

    function calculateTaxes(gross,allowances){

        var totalTax = 0.0;
        var ssnit = gross * ssnitRate / 100.0;
        var taxableRemaining = (gross - ssnit) + allowances;

        console.log('Allowances: ' + allowances);
        console.log('Gross: ' + gross);
        console.log('SSNIT: ' + ssnit);
        console.log('Initial Taxable: ' + taxableRemaining);

        for (var i = 0; i < taxRates.length; i++) {
            if(taxableRemaining > 0){ //if there's money left to be taxed
                var tranche = taxableRemaining > taxRates[i][1]? taxRates[i][1] : taxableRemaining; //ternary operator
                var tax = taxRates[i][0] * tranche /100.0;
                totalTax += tax;
                taxableRemaining -= tranche;
                console.log((i+1) +' Tax: ' + tax);
                console.log((i+1) +' Tranche: ' + tranche);
                console.log((i+1) +' Taxable: ' + taxableRemaining);
            }
        }
        return [totalTax,ssnit];
    }

    $('#submit-button').click(function(){
        var gross = $('#gross-income').val();
        var allowance = $('#allowances').val();

        gross = Number(gross);
        allowance = Number(allowance);

        var taxes = calculateTaxes(gross,allowance);

        $('#income-tax').html('Income Tax: GHC '+taxes[0]);
        $('#ssnit-deduction').html('SSNIT: GHC '+taxes[1]);
        $('#net-income').html('Net Income: GHC '+ (gross + allowance - taxes[0] - taxes[1]));
    });

</script>
</body>
</html>